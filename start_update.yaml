---
    - hosts: all
      become: true
    
        - name: rollback and backup user data
            include_tasks: rollback.yaml
        
        - name: add docker network
          shell: "docker network create wordpress-network"
          args:
            executable: /bin/bash
        
        - name: Create a directory if it does not exist
          file:
            path: /data/wordpress
            state: directory
            owner: user
            group: user
            mode: '0755'
       
        - name: add docker network
          shell: |
              docker volume create --name mariadb_data
              docker run -d --name mariadb \
              --env ALLOW_EMPTY_PASSWORD=yes \
              --env MARIADB_USER=bn_wordpress \
              --env MARIADB_DATABASE=bitnami_wordpress \
              --network wordpress-network \
              --volume mariadb_data:/bitnami/mariadb \
              bitnami/mariadb:latest
          args:
            executable: /bin/bash
        
        - name: add docker network
          shell: |
              docker run -d --name wordpress \
              -p 8080:8080 -p 8443:8443 \
              -e ALLOW_EMPTY_PASSWORD=yes \
              -e WORDPRESS_DATABASE_USER=bn_wordpress \
              -e WORDPRESS_DATABASE_NAME=bitnami_wordpress \
              --network wordpress-network \
              --volume wordpress_data:/date/wordpress \
              bitnami/wordpress:latest
          args:
            executable: /bin/bash